rule Php_Trojan_Sysbat_1
{
strings:
	$a0 = { 0d0a2f2f205359534241542e504850205649525553200d0a2f2f20427920586d6f726669632c207777772e736861646f7776782e636f6d2f626376672c2054686520426c61636b204361742056697269692047726f75700d0a2f2f205359534241542e504850202d205468 }

condition:
	$a0
}
rule Php_Trojan_Pbot_3
{
strings:
	$a0 = { 707269766d736728746869732d3e636f6e6669675b276368616e275d2c225b5c32707363616e5c325d3a20222e6d636d645b315d2e223a222e6d636d645b325d2e22206973205c326f70656e5c3222293b20656c736520746869732d3e707269766d736728746869732d3e636f6e6669675b276368616e275d2c225b5c32707363616e5c325d3a20222e6d636d645b315d2e }

condition:
	$a0
}
rule Php_Trojan_MSShellcode_82
{
strings:
	$a0 = { 696620282169737365742824474c4f42414c535b276368616e6e656c73275d2929207b2024474c4f42414c535b276368616e6e656c73275d203d206172726179 }

condition:
	$a0
}
rule Php_Trojan_MSShellcode_81
{
strings:
	$a0 = { 73797374656d286261736536345f6465636f64652827634756796243417454556c504943316c4943636b6344316d62334a724b436b375a586870644378705a69 }

condition:
	$a0
}
rule Php_Trojan_Agent_36999
{
strings:
	$a0 = { 3c3f706870[0-15]6563686f206578656328276364202f746d703b6375726c202d6f[0-150]6563686f206578656328276364202f746d703b6c77702d646f776e6c6f6164[0-150]6563686f206578656328276364202f746d703b77676574[0-150]6563686f206578656328276364202f746d703b6665746368[0-150]6563686f20706173737468727528276364202f746d703b6665746368 }

condition:
	$a0
}
rule Php_Trojan_Agent_36998
{
strings:
	$a0 = { 69662821656d70747928245f6765745b2766696c65275d2929202466696c653d245f6765745b2266696c65225d3b }
	$a1 = { 69662866616c73653d3d6375726c5f65786563282463682929206469652827[0-150]6375726c5f636c6f736528246368293b203f3e20627970617373207368656c6c3a }

condition:
	$a0 and $a1
}
rule Php_Trojan_Agent_36992
{
strings:
	$a0 = { 2463686469723d67657463776428293b20696628212477686f616d69292477686f616d693d65786563282277686f616d6922293b203f3e3c3f70687020407365745f74696d655f6c696d69742830293b }
	$a1 = { 61646d696e6973747261746f7273203b2f6164642061646d696e3b206e6574206c6f63616c67726f75703b2075736572733b202f64656c2061646d696e273b2024626e203d20246d686f73743b }

condition:
	$a0 and $a1
}
rule Php_Trojan_Agent_36811
{
strings:
	$a0 = { 7b20657865632824636d642c246f293b202472657a203d206a6f696e28726e2c246f293b207d20656c736569662028656e61626c6564287368656c6c5f657865632929207b202472657a203d207368656c6c5f657865632824636d64293b207d20656c736569662028656e61626c65642873797374656d2929207b20406f625f737461727428293b204073797374656d2824636d64293b202472657a203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c736569662028656e61626c65642870617373746872752929 }

condition:
	$a0
}
rule Php_Trojan_Agent_37000
{
strings:
	$a0 = { 61727261792861646d696e203d3e20617272617928226e616d6522203d3e2061646d696e2c20227061737322203d3e20626f745f70617373776f72642c20226175746822203d3e20312c2273746174757322203d3e202261646d696e2229293b }

condition:
	$a0
}
rule Php_Trojan_Agent_36982
{
strings:
	$a0 = { 3c3f70687020247b225c7834375c7834635c78346642414c5c783533227d5b2262705c7836615c78363475635c783738225d3d225c7836365c7837355c78366563223b247b22474c4f42415c7834635c783533227d5b225c7837387a5c783738655c7836665c7836616b715c7836365c7836335c7837356d225d3d225c783638 }

condition:
	$a0
}
rule Php_Trojan_Agent_36983
{
strings:
	$a0 = { 3c3f706870206576616c28677a696e666c617465286261736536345f6465636f646528224263464a6b716f7741414451752f5371753178416c4c473665694569436a4961426e487a43306b5967786943674a7a2b7634656e6a487958612f3073534462693730664773435438517a6a764566372b306e4c44616d6b2f372f6436 }

condition:
	$a0
}

rule Php_Trojan_Uploader_2
{
    strings:
	$a1 = "$s21=strtolower($sf[4].$sf[5].$sf[9].$sf[10].$sf[6].$sf[3].$sf[11].$sf[8].$sf[10].$sf[1].$sf[7].$sf[8].$sf[10])" nocase
	$a2 =  "$s20=strtoupper($sf[11].$sf[0].$sf[7].$sf[9].$sf[2])" nocase

    condition:
        all of them
}

rule Php_Trojan_itsoknoproblembro_2
{
strings:
	$a0 = { 6576616c28677a696e666c617465286261736536345f6465636f646528277679356e73387177656962766776396877616f396c733579756e676d636571706e6e7970686d6562367361716c35766a3676727274767375706d33782b373770306b67643768706e716f743978652b696574727a626f676a6d36756f78346a6e3874776362356671676c646a31657866336770323967636a786a6b7269396e78616a357163737766647675733362366474386177686f78763332376c636d312f79656567626b756477757761727a626269386f726c63643075636b677865622b356969776c6c7332657764756633776a6b66666335636d6e6b6a7674736776772b6a677a6b766b6d3065316874753367656e6830773063672f3274726f65777a6d777878746a6e656b647161636c707a6d736d762f782b786e6b7172333969696671727277393373772b7539767a342f7062626537766164272929293b }

condition:
	$a0
}
rule Php_Trojan_itsoknoproblembro_3
{
strings:
	$a0 = { 69662866756e6374696f6e5f65786973747328276578656327292940657865632824636d64293b }
	$a1 = { 656c736569662866756e6374696f6e5f657869737473282770617373746872752729294070617373746872752824636d64293b }
	$a2 = { 656c736569662866756e6374696f6e5f65786973747328277368656c6c5f65786563272929407368656c6c5f657865632824636d64293b }
	$a3 = { 656c736569662866756e6374696f6e5f657869737473282773797374656d2729294073797374656d2824636d64293b }
	$a4 = { 656c736569662866756e6374696f6e5f6578697374732827706f70656e27292940706f70656e2824636d642c227222293b }

condition:
	$a0 and $a1 and $a2 and $a3 and $a4
}
rule Php_Trojan_Agent_36933
{
strings:
	$a0 = { 2f2f206e6f206d616c77617265206f6e207468697320636f64652c20796f752063616e20636865636b20697420627920796f757273656c66203b[0-200]6576616c28223f3e222e677a696e666c617465286261736536345f6465636f64652822 }

condition:
	$a0
}
rule Php_Malware_ProPOS_3
{
strings:
	$a0 = { 2469643d223c6120687265663d223f73686f773d6c6f677326687769643d22202e2068746d6c656e7469746965732824726f775b2768776964275d29202e2027223e27202e2068746d6c656e7469746965732824726f775b2768776964275d29202e20273c2f613e4027202e2068746d6c656e7469746965732824726f775b2770636e275d202e20272069703a2027202e2068746d6c656e7469746965732824726f775b276c6173746970275d292029202e2027202827202e2068746d6c656e7469746965732824726f775b2776657273696f6e275d29202e202729202e206c617374207365656e206f6e2027202e2064617465282720683a693a73272c2024726f775b277365656e275d29 }

condition:
	$a0
}
rule Php_Trojan_Mailer_14
{
strings:
	$a0 = { 6966286d61696c2824656d61696c312c2024617373756e746f2c20245f7365727665725b27687474705f686f7374275d202e20245f7365727665725b27726571756573745f757269275d2c202468656164657329297b206563686f20226f70612c20656e766961646f21223b206578697428293b207d20656c73657b206563686f20226e3f6f20656e766965692e2e223b206578697428293b20 }

condition:
	$a0
}
rule Php_Exploit_CVE_2011_4885_1
{
strings:
	$a0 = { 3d26457a457a457a457a457a[6]3d26457a457a457a457a457a[6]3d26457a457a457a457a457a[6]3d26457a457a457a457a457a }

condition:
	$a0
}
rule Php_Trojan_Rebots_1
{
strings:
	$a0 = { 3c736372697074[0-5]207372633d[1]687474703a2f2f }
	$a1 = { 2f7265626f74732e706870 }

condition:
	$a0 and $a1
}
rule Php_Trojan_MSShellcode_77
{
strings:
	$a0 = { 202020200a202020202020407365745f74696d655f6c696d69742830293b204069676e6f72655f757365725f61626f72742831293b2040696e695f7365742827 }

condition:
	$a0
}
rule Php_Trojan_itsoknoproblembro_1
{
strings:
	$a0 = { 7072696e7420223c73746f70636c65616e646f733e73746f70202620636c65616e3c2f73746f70636c65616e646f733e22 }
	$a1 = { 5b27616374696f6e275d3d3d227374617475732229 }

condition:
	$a0 and $a1
}
rule Php_Trojan_MSShellcode_79
{
strings:
	$a0 = { 2463203d206261736536345f6465636f646528225a574e6f6279416964473976636a6f364d446f774f6a6f364c324a706269396959584e6f496a34765a58526a }

condition:
	$a0
}
rule Php_Trojan_WebShell_10
{
strings:
	$a0 = { 677a756e636f6d7072657373286261736536345f6465636f64652822656a7a7376773270716b72336e2f682b6b766b6f382b352f6a2f396b61716839627a6e6a6a6f3063696f6a6e717276736279796f6e6b79706c6e31742b2f74707a3632717773626476612f6863392b7a7375356f7a6434327572776531322b746b6f722f362f2f2b707a616e787079707666362b6565722f7038766d667367322f2b6f2f78746768776c766c6836766170666c34657467647462656c737a687a6a2b }

condition:
	$a0
}
rule Php_Trojan_WebShell_11
{
strings:
	$a0 = { 245f5f5f203d20225c7836325c3134315c7837335c3134355c7833365c36345c7835665c3134345c7836355c3134335c7836665c3134345c783635223b6576616c28245f5f5f28245f5f2929 }

condition:
	$a0
}
rule Php_Trojan_Agent_36995
{
strings:
	$a0 = { 6576616c28677a696e666c617465286261736536345f6465636f646528272037663135662b6f32726a676f2f33382f6e2f73656e67706f6a323463623368326a71337832696c33207a352b7a6a3065327a666e78696b6573313935353777396175686b313268676d37626e6e666e396e2032686e627865637162656561626d68666c6e2f }

condition:
	$a0
}
rule Php_Trojan_Agent_36994
{
strings:
	$a0 = { 22646f6d61696e3d74657272612e636f6d2e627226757365726e616d653d22202e2024656d61696c5b305d202e20222670617373776f72643d22202e2024617574685b315d3b2024686561646572203d2022706f7374202f61746d61696c2e7068703f }
	$a1 = { 24636d64203d206578706c6f6465282220222c202464617461293b2069662824636d645b305d203d3d202273656e6422297b2069662824636d645b325d20213d2024676c6f5b2273656e6861225d29 }

condition:
	$a0 and $a1
}
rule Php_Trojan_Agent_36993
{
strings:
	$a0 = { 6576616c286261736536345f6465636f646528276c796f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b696f716b69386e6369387163716c747a7872306177356e63 }

condition:
	$a0
}
rule Php_Trojan_Agent_36961
{
strings:
	$a0 = { 6563686f28677a696e666c617465286261736536345f6465636f646528223556624e63707377454c37334b53676e4744 }

condition:
	$a0
}
rule Php_Trojan_Turame_1
{
strings:
	$a0 = { 57304435307a62444d34512b54565257736d664955734877635a39425a695837754762344f47464c4b662b457a66424a516a39425646617954354949355a2b794464326e546d2b456e77316d4a6673306f6339697372465061795036616247456f2f7935514661797a784436484662386a42627a4d796f2b4f6b5038455a38644870714f597a5973392b4a2f567a3679517655452f33334a794a4b323853396b4969744b78714d3633697a726c5944377750335044694c797570384839684370746c704f527264363862494d4872497155687053396a4471304a7875503056576a6877685854476470696d7a463358534337763935466946504d50654d4b515a796a5a466e664443626a2f5031554b656156584d6f706c4b39614a4f31724a75503076554d703574566379683256354664436a6c6c506f522f2f4f4e395431397246514f7237464653485039327549444a612f43714e33517779706b4f4c79756a524878586d337848564c41564f3336686f3547786e6968566275494676713178656447555a334a76596e563851583239694264344e6357587858467a556274786c62574c49507464653246744d53764c543465466e61597465745a4231396b3156354d462f6d3178546643346d367a64675072356b767372554736784b38745067575739756d6e624f78725a5831386d5656374f56336d317859722f7556624465366d6572615672374271723651722f4e70694271336359665267617a33627756665a32344a306c563962544b505333535a334239764e56317531792b687176375a5970706564623343334e4c4c7a5a52792f726c314f312f693178544b36664d436f33646250426e6946765356494b377a61754e386647544c487370304e7965422b5862754b5676713178617971476a56726437425247657176617a4e613764635773346f644d32763373574d38616d3848307168665738797174644e6d375834327a57757332725730787138745a6c587476446e79 }

condition:
	$a0
}
rule Php_Trojan_Turame_2
{
strings:
	$a0 = { 6334636134323338613062393233383230646363353039613666373538343962613238346439623465396464616635363665613763373436316563376461313062633131663036616662396232373037303637333437316132336563633661395a6e52774f693876 }

condition:
	$a0
}
rule Php_Trojan_IRCBot_865
{
strings:
	$a0 = { 72746a696f3965656b6678626377656b656b7774767a306c6b7972776d787a62666b643377646375657a6d726876376d6530636a723077642b73767072786e7075742f38657a786a6d646b6a3677673675336a6e73386b757a2b33732f6e6a3d3d223b406576616c28677a696e666c617465286261736536345f6465636f6465287374725f726f7431332824636f646529292929 }

condition:
	$a0
}
rule Php_Trojan_IRCBot_864
{
strings:
	$a0 = { 726f743133286261736536345f6465636f646528273766316d74366e6c6b69676d72717038796b33727276767772352f6972367a726573757064626967696a7079666a6e316169716167746b6a2f746b64716d796a6b726f376631692f396c752f39747633727671786e6e697a2f6c6a377a706677796b79717536727a6e63756a6e727a36327a617a65676f646171636b75653778346c6b726c626b6c656c6f39773876736d2f7475786f6b6d792b79742f782f37707a6979666665763337376c746f327072356f38716c2f392f6e6e63733070627874657676762b332f2f7a637336646e3363 }

condition:
	$a0
}
rule Php_Malware_SoakSoakRedirect_1
{
strings:
	$a0 = { 6563686f20223c616c6c5f6f6b5f73716c5e222e24706173735f776f72642e223a222e24756e6d652e223e5c6e223b }

condition:
	$a0
}
rule Php_Trojan_Script_9
{
strings:
	$a0 = { 3c3f206576616c28677a696e666c617465286261736536345f6465636f64652827 }
	$a1 = { 27292929 }

condition:
	$a0 and $a1
}
rule Php_Trojan_Rayman_2
{
strings:
	$a0 = { 3c623e72656d6f7661626c65207368656c6c206279207261796d616e3c2f623e }

condition:
	$a0
}
rule Php_Exploit_Shell_63
{
strings:
	$a0 = { 686a33686a7574636b6f72667078663961317a716f326177647272726579397567767465657a37397161616f316130726775646b7a6b72387261702f2f6f2f2f2f6f6466787a6e302f3172766d357a397368662f6270763633337861796673666e6e6b6b61767476786d727478767a7a62306c627078757973723433796a6e79366a62353561637a6a7934797a75662f6f6a2f64636172303968626b6e72696c622f6f6b65632b7073786138667a }

condition:
	$a0
}
rule Php_Trojan_MSShellcode_107
{
strings:
	$a0 = { 0a202020202020407365745f74696d655f6c696d69742830293b204069676e6f72655f757365725f61626f72742831293b2040696e695f73657428276d61785f }

condition:
	$a0
}
rule Php_Trojan_MSShellcode_106
{
strings:
	$a0 = { 20202020246970616464723d2731302e372e37372e313836273b0a2020202024706f72743d343434343b0a202020200a202020202020407365745f74696d655f }

condition:
	$a0
}
rule Php_Trojan_MSShellcode_109
{
strings:
	$a0 = { 233c3f7068700a0a6572726f725f7265706f7274696e672830293b0a2320546865207061796c6f61642068616e646c6572206f76657277726974657320746869 }

condition:
	$a0
}
rule Php_Trojan_MSShellcode_108
{
strings:
	$a0 = { 233c3f7068700a0a2320546865207061796c6f61642068616e646c6572206f766572777269746573207468697320776974682074686520636f7272656374204c }

condition:
	$a0
}
rule Php_Trojan_Webshell_5
{
strings:
	$a0 = { 27687474702f312e31203530302027 }
	$a1 = { 297b[0-2]73797374656d2824??293b7d }
	$a2 = { 7b24??3b[0-2]657865632824??2c24??293b6563686f20[0-2]696d706c6f646528225c6e222c24??293b7d }
	$a3 = { 227768696368207375706572666574636820313e202f6465762f6e756c6c20323e202f6465762f6e756c6c202626206563686f206f6b2229 }

condition:
	$a0 and $a1 and $a2 and $a3
}
rule Php_Trojan_C99Shell_3
{
strings:
	$a0 = { 3c3f206576616c28677a696e666c617465286261736536345f6465636f64652827203762337065756a69306a64362b35336e6d787471717433646468736a7768677276376d6831637a6d206236397664747863636a627a686375626e763377627a31722b7035397633796963706673637a6175207175357a7a76726d743165756b7a66627a65726b7a6d72766a78392b6d77366d662f326c6f7271632031786b6d73762f73316e68692f7574666a6a36302b6134336d32696f79753775397366646475786e207561383779306f7a746d }

condition:
	$a0
}
rule Php_Trojan_C99Shell_2
{
strings:
	$a0 = { 6578706c6f646528223a222c6667657473282466702c3230343829293b[1-8]696620286339396674706272757465636865636b28226c6f63616c686f7374222c32312c312c247374725b305d2c247374725b305d2c247374725b365d2c246671625f6f6e6c797769746873682929[3-18]6563686f20223c623e436f6e6e656374656420746f20222e }

condition:
	$a0
}
rule Php_Trojan_C99Shell_5
{
strings:
	$a0 = { 37696776346178713764716f766c32666b7a636277616861676467666e637962697a777a76636d756764786e687a32756e6367306b707a346e63673d3d223b6576616c286261736536345f6465636f6465282471626462353165323562663961376633643234373530373238303364316333366429293b3f3e }

condition:
	$a0
}
rule Php_Trojan_C99Shell_4
{
strings:
	$a0 = { 6677717a773777336e2f706c71766c6c776b79203373642b35742f366b313466687a7a316a736263746876623975636e6a7873626b6262737475647075686a6572712f6432746e7839392b62726c6a71616f6c776e6833686677653d223b406576616c28677a696e666c617465286261736536345f6465636f6465282461677a2929293b3f3e }

condition:
	$a0
}
rule Php_Exploit_CVE_2011_4153_1
{
strings:
	$a0 = { 3c3f }
	$a1 = { 74696479[0-50]2d3e646961676e6f73652829 }

condition:
	$a0 and $a1
}
rule Php_Trojan_CryptoPHP_1
{
strings:
	$a0 = { 3c3f70687020696e636c756465202827696d616765732f736f6369616c2e706e6727293b203f3e }

condition:
	$a0
}
rule Php_Trojan_Agent_36974
{
strings:
	$a0 = { 3c3f2024474c4f42414c535b275f3433333330353834365f275d3d4172726179286261736536345f6465636f6465282727202e275a4727202e27566d6127202e2757356c27292c6261736536345f6465636f646528275a6d6c735a56396e27202e275a585266593227 }

condition:
	$a0
}
rule Php_Exploit_CVE_2011_4153_2
{
strings:
	$a0 = { 3c3f }
	$a1 = { 646566696e6528[0-20]7374725f72657065617428[0-5]22??222c[0-4]2461726776 }

condition:
	$a0 and $a1
}
rule Php_Trojan_Envl_1
{
strings:
	$a0 = { 7368656c6c6e616d65 }
	$a1 = { 656e766c70617373 }
	$a2 = { 687474703a2f2f7777772e376a796577752e636e2f }

condition:
	$a0 and $a1 and $a2
}
rule Php_Trojan_Agent_36956
{
strings:
	$a0 = { 646566696e6528275041535f524553272c2027633938396637323232373763346332356132323627293b0d0a646566696e6528275041535f524551272c2027333139316665376361613461623665346633653927293b0d0a646566696e6528275253415f4c454e272c20273235362729 }

condition:
	$a0
}
rule Php_Trojan_Spambot_292
{
strings:
	$a0 = { 7b20646965285048505f4f532e636872283439292e636872283438292e636872283433292e6d6435283039383736353433323129293b207d }

condition:
	$a0
}
rule Php_Trojan_Spambot_293
{
strings:
	$a0 = { 665b3c70616c64667c5d7d6d407e37392f6f386b785c72683672262d63356b5c6e33782c797a68713e2063705c5c777575326a676f623b30695f736e5c746e257667297a695e73747279766c7b5c243a3d312a6d652b6a772871342e74276061215c22236564623f }

condition:
	$a0
}
rule Php_Trojan_Anonghost_1
{
strings:
	$a0 = { 247a643435666635613d225c7836325c7836315c3136335c7836355c7833365c36345c3133375c783634 }

condition:
	$a0
}
rule Php_Trojan_Scew_1
{
strings:
	$a0 = { 3c3f7068702040246f75747075743d73797374656d28245f706f73745b22636f6d6d616e64225d293b }
	$a1 = { 6f72206120636f6e6e656374206261636b207368656c6c2c207573653a203c693e6e63202d6520636d }

condition:
	$a0 and $a1
}
rule Php_Trojan_Io_1
{
strings:
	$a0 = { 0d0a2f2f205048502e496f4261726163756461206f72205048502e496f2069732061207068702076697275732e200d0a2f2f200909427920586d6f726966632f4243564720616e642044722e542f4243564720323030310d0a2f2f696e6665637473206175746f65786563 }

condition:
	$a0
}
rule Php_Trojan_Agent_36804
{
strings:
	$a0 = { 3c3f206576616c28677a696e666c617465286261736536345f6465636f64652827203762313777397469736a6a38642f7a35396a736f676d796764387933696f6573796d6f786a6d6567206a6130656b767938736933627768637a7362797832787a3374366f767572636b6735706d376f34352037386d75623773763164337633647876317878356570746834376733 }

condition:
	$a0
}
rule Php_Trojan_Agent_36803
{
strings:
	$a0 = { 247832343d225c31363374725c313534655c783665223b20247832353d225c783733795c3136335c3136345c7836355c313535223b2066756e6374696f6e20636f6e7665727462797465732824783062297b20676c6f62616c20247831632c247831642c247831652c247831662c247832302c247832312c247832322c247832332c247832342c247832353b2024783063203d20247832342824783062293b69662824783063203c2034297b72657475726e20247832 }

condition:
	$a0
}
rule Php_Trojan_Agent_36802
{
strings:
	$a0 = { 246f6f6f306f306f30303d5f5f66696c655f5f3b246f30306f30306f30303d5f5f6c696e655f5f3b246f6f30306f303030303d34323839363b6576616c28677a756e636f6d7072657373286261736536345f6465636f64652827656e706c6a386475776b617968662f6730753471726c6d6934346173682b69647062646c35706b37676275376c73647462787265686b6b7a30326a6d6b307a69 }

condition:
	$a0
}
rule Php_Trojan_Agent_36801
{
strings:
	$a0 = { 6576616c28677a696e666c617465286261736536345f6465636f64652827666a33686471766d656b796635353631676a64746b6368797a706f3763636b64796f6e70667a793062 }
	$a1 = { 666c6c6677777265353464737a6f6a6f6d78637870797a306d6c686864676974746d34676a3171617a2b6836736271303163656c34346761673163616f77777169697a7732347634756237706c2b7068742f316479616162666532382f696d78 }

condition:
	$a0 and $a1
}
rule Php_Trojan_Agent_1388761
{
strings:
	$a0 = { 6d61696c2822736e65616b657231393732407765622e6465 }

condition:
	$a0
}
rule Php_Trojan_IRCBot_868
{
strings:
	$a0 = { 656c7365696620282464636f6d5b305d3d3d276e6f746963652729207b2024636f6d203d206578706c6f6465282220222c202464617461293b206966202824636f6d5b335d3d3d273a6b62272026262024636f6d5b345d2026262024636f6d5b355d2026262024636f6d5b365d29207b20246d7367203d207374725f7265706c6163652827272c27272c2464617461293b20246d7367203d2073747273747228246d73672c223a6b6222293b }
	$a1 = { 636179616e6b28246e69636b293b }

condition:
	$a0 and $a1
}
rule Php_Trojan_MSShellcode_78
{
strings:
	$a0 = { 20202020696620282166756e6374696f6e5f65786973747328277379735f6765745f74656d705f646972272929207b0a20202020202066756e6374696f6e2073 }

condition:
	$a0
}
rule Php_Trojan_Rst_1
{
strings:
	$a0 = { 24706f72745f62696e645f62645f706c3d224979457664584e794c324a70626939775a584a7344516f6b55306846544577394969396961573476596d467a6143417461534937445170705a69416f5145465352315967502a623e6f2d2d2d5b207235377368656c6c202d20687474702d7368656c6c206279205253542f474843 }

condition:
	$a0
}
rule Win_Trojan_Shell_24
{
strings:
	$a0 = { 5f737461727428293b2073797374656d2824636d64293b20246f7574707574203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c73656966202820656e61626c656428226578656322292029207b20657865632824636d642c246f293b20246f7574707574203d206a6f696e28225c725c6e222c246f293b207d20656c73656966202820656e61626c656428227368656c6c5f6578656322292029207b20246f7574707574203d207368656c6c5f657865632824636d64293b207d2072657475726e20246f75747075743b207d2066756e6374696f6e206678323965786563322824636d6429207b20246f7574707574203d2022223b206966 }

condition:
	$a0
}
rule Win_Trojan_Shell_25
{
strings:
	$a0 = { 6f6e732c27657865632729297b657865632824636f6d6d616e642c246f7574707574293b246f75747075743d6a6f696e28225c6e222c246f7574707574293b24657865633d246f75747075743b7d20656c736569662869735f63616c6c61626c6528277368656c6c5f6578656327292026262021737472737472282464697361626c6566756e6374696f6e732c277368656c6c5f657865632729297b24657865633d7368656c6c5f657865632824636f6d6d616e64293b7d20656c736569662869735f7265736f7572636528246f75747075743d706f70656e2824636f6d6d616e642c2272222929297b7768696c65282166656f6628246f757470757429297b24657865633d666765747328246f7574707574293b7d70636c6f736528246f75 }

condition:
	$a0
}
rule Win_Trojan_Shell_60
{
strings:
	$a0 = { 377175653969743273786c3578636c66736e6c6d2f6167647976346f6363346e696d6372647037756e7565346e61736c34356d707530686c6b36696e617a3062627265717032616272766c6a7476366173677a6c34772b6a65672b6b7536766e6d3363796678676b77716b3574763767 }

condition:
	$a0
}
rule Win_Trojan_Shell_61
{
strings:
	$a0 = { 6563686f206578656328276364202f746d703b6375726c202d4f20687474703a2f2f3130302d6d61747261736f762e72752f776562737461742f68616e7961722e7478743b7065726c2068616e7961722e7478743b726d202d72662068616e7961722e7478742a3b27293b }

condition:
	$a0
}
rule Win_Trojan_Shell_16
{
strings:
	$a0 = { 245f706f73745b27636d64275d3d226c73202d6c61223b207d206563686f20223c666f6e7420666163653d76657264616e612073697a653d2d323e222e246c616e675b246c616e67756167652e5f74657874315d2e223a203c623e222e245f706f73745b27636d64275d2e223c2f623e3c2f666f6e743e3c2f74643e3c2f74723e3c74723e3c74643e223b206563686f20223c623e223b206563686f20223c64697620616c69676e3d63656e7465723e3c7465787461726561206e616d653d7265706f727420636f6c733d31323220726f77733d31353e223b206563686f2022222e706173737468727528245f706f73745b27636d64275d292e22223b }

condition:
	$a0
}
rule Win_Trojan_Shell_11
{
strings:
	$a0 = { 66756e6374696f6e206578282463666529207b2024726573203d2027273b206966202821656d70747928246366652929207b2069662866756e6374696f6e5f657869737473282765786563272929207b20406578656328246366652c24726573293b2024726573203d206a6f696e28225c6e222c24726573293b207d20656c736569662866756e6374696f6e5f65786973747328277368656c6c5f65786563 }

condition:
	$a0
}
rule Win_Trojan_Shell_13
{
strings:
	$a0 = { 6563686f20246f75743d282273797374656d223d3d2473656c65746566756e63293f73797374656d28247368656c6c636d64293a28282473656c65746566756e633d3d226578656322293f6578656328247368656c6c636d64293a28282473656c65746566756e633d3d227368656c6c5f6578656322293f7368656c6c5f6578656328247368656c6c636d64293a28282473656c65746566756e633d3d22706173737468727522293f706173737468727528247368656c6c636d64293a73797374656d28247368656c6c636d642929 }

condition:
	$a0
}
rule Win_Trojan_Shell_12
{
strings:
	$a0 = { 6966202821656d707479282463666529297b2069662866756e6374696f6e5f6578697374732827657865632729297b20406578656328246366652c24726573293b20247265733d6a6f696e28225c6e222c24726573293b207d2e2c2c617320406f625f656e6420656c736569662866756e6374696f6e5f65786973747328277368656c6c5f657865632729297b20247265733d407368656c6c5f657865632824636665293b207d20656c736569662866756e6374696f6e5f657869737473282773797374656d2729297b }

condition:
	$a0
}
rule Win_Trojan_Shell_46
{
strings:
	$a0 = { 717765333234613d227322262268652226226c2226226c2e2226226170706c22262269222622636122262274692226226f6e2273657420713d64662e6372656174656f626a65637428717765333234612c22222961736477723d226f70222622652226226e22712e7368656c6c65786563757465 }

condition:
	$a0
}
rule Win_Trojan_Shell_42
{
strings:
	$a0 = { 696620284066756e6374696f6e5f657869737473282765786563272929207b2040657865632824636f6d6d616e642c2024726573293b20247265733d406a6f696e28225c6e222c2024726573293b207d20656c7365696620284066756e6374696f6e5f65786973747328277368656c6c5f65786563272929207b20247265733d407368656c6c5f657865632824636f6d6d616e64293b207d20656c73656966284066756e6374696f6e5f657869737473282773797374656d272929207b20406f625f737461727428293b204073797374656d2824636f6d6d616e64293b20247265733d406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c7365696620284066756e6374696f6e5f65786973747328277061737374687275272929 }

condition:
	$a0
}
rule Win_Trojan_Shell_43
{
strings:
	$a0 = { 69662866756e6374696f6e5f6578697374732827657865632729297b20657865632824636f6d642c24726573293b20247265733d696d706c6f646528225c6e222c24726573293b207d656c736569662866756e6374696f6e5f65786973747328277368656c6c5f657865632729297b20247265733d7368656c6c5f657865632824636f6d64293b207d656c736569662866756e6374696f6e5f657869737473282773797374656d2729297b206f625f737461727428293b2073797374656d2824636f6d64293b20247265733d6f625f6765745f636f6e74656e747328293b206f625f656e645f636c65616e28293b207d656c736569662866756e6374696f6e5f657869737473282770617373746872752729297b206f625f737461727428293b2070617373746872752824636f6d64293b }

condition:
	$a0
}
rule Win_Trojan_Shell_41
{
strings:
	$a0 = { 737472696e67205b5d62617368636d643d7b222f62696e2f7368222c222d63222c636d647d3b2068746d6c3d726571756573742e676574706172616d65746572282268746d6c22293b206966202868746d6c20213d6e756c6c29207b206f75742e7072696e746c6e28223c68746d6c3e22293b207d2070203d2072756e74696d652e67657472756e74696d6528292e657865632862617368636d64293b }

condition:
	$a0
}
rule Win_Trojan_Shell_22
{
strings:
	$a0 = { 76616c287375627374722873747273747228246d73672c246d636d645b315d292c7374726c656e28246d636d645b315d2929293b20627265616b3b2063617365202265786563223a2024636f6d6d616e64203d207375627374722873747273747228246d73672c246d636d645b305d292c7374726c656e28246d636d645b305d292b31293b202465786563203d207368656c6c5f657865632824636f6d6d616e64293b2024726574203d206578706c6f646528225c6e222c2465786563293b2024746869732d3e707269766d73672824746869732d3e636f6e6669675b276368616e275d2c225b5c32657865635c325d3a2024636f6d6d616e6422293b20666f722824693d303b24693c636f756e742824726574293b24692b2b292069662824 }

condition:
	$a0
}
rule Win_Trojan_Shell_23
{
strings:
	$a0 = { 7328226d797368656c6c65786563222929207b2066756e6374696f6e206d797368656c6c657865632824636d6429207b2024726573756c74203d2022223b206966202821656d7074792824636d642929207b206966202869735f63616c6c61626c65282265786563222929207b657865632824636d642c24726573756c74293b2024726573756c74203d206a6f696e28225c6e222c24726573756c74293b7d20656c73656966202869735f63616c6c61626c6528227368656c6c5f65786563222929207b24726573756c74203d207368656c6c5f657865632824636d64293b7d20656c73656966202869735f63616c6c61626c65282273797374656d222929207b406f625f737461727428293b2073797374656d2824636d64293b2024726573756c74203d20406f625f6765745f636f }

condition:
	$a0
}
rule Win_Trojan_Shell_26
{
strings:
	$a0 = { 7475726e202e3d6672656164282470702c2032303936293b2070636c6f736528247070293b207d656c73657b202472657475726e202e3d20282273797374656d223d3d2473656c65746566756e63293f73797374656d28247368656c6c636d64293a28282473656c65746566756e633d3d226578656322293f6578656328247368656c6c636d64293a28282473656c65746566756e633d3d227368656c6c5f6578656322293f7368656c6c5f6578656328247368656c6c636d64293a28282473656c65746566756e633d3d22706173737468727522293f706173737468727528247368656c6c636d64293a73797374656d28247368656c6c636d64292929293b }

condition:
	$a0
}
rule Win_Trojan_Shell_27
{
strings:
	$a0 = { 662866756e6374696f6e5f6578697374732870617373746872752929207b2070617373746872752824636d64293b207d20656c7365207b2069662866756e6374696f6e5f65786973747328657865632929207b206578656328226c73202d6c61222c24726573756c74293b20666f72656163682824726573756c7420617320246f757470757429207b207072696e7420246f75747075742e223c62723e223b207d207d20656c7365207b2069662866756e6374696f6e5f6578697374732873797374656d2929207b2073797374656d2824636d64293b207d20656c7365207b2069662866756e6374696f6e5f657869737473287368656c6c5f657865632929207b207072696e74207368656c6c5f657865632824636d64293b207d20656c7365 }

condition:
	$a0
}
rule Win_Trojan_Shell_68
{
strings:
	$a0 = { 3c3f7068700a[0-64]24636f6c6f72203d202223646635223b0a2464656661756c745f616374696f6e203d202746696c65734d616e273b0a2464656661756c745f7573655f616a6178203d20747275653b0a2464656661756c745f63686172736574203d202757696e646f77732d31323531273b0a707265675f7265706c61636528222f2e2a2f65222c22 }

condition:
	$a0
}
rule Win_Trojan_Shell_69
{
strings:
	$a0 = { 247a656e645f6672616d65776f726b3d225c7836335c3136325c7836355c3134315c7837345c3134355c7835665c3134365c7837355c3135365c7836335c3136345c7836395c3135375c783665223b20406572726f725f7265706f7274696e672830293b20247a656e645f6672616d65776f726b2822222c }

condition:
	$a0
}
rule Win_Trojan_Shell_30
{
strings:
	$a0 = { 706870206563686f2024736868636d643b203f3e22202f3e203c696e70757420747970653d227375626d6974222076616c75653d226578656375746522202f3e3c6272202f3e3c3f706870206563686f20223c746578746172656120777261703d5c226f66665c2220726561646f6e6c7920726f77733d5c2232355c2220636f6c733d5c223130305c223e223b2069662828247368687074723d3d2730272926262824736868636d64213d272729297b20696628657865632824736868636d642c20246f757429297b206563686f2068746d6c656e74697469657328696d706c6f646528225c6e222c246f75 }

condition:
	$a0
}
rule Win_Trojan_Shell_51
{
strings:
	$a0 = { 69662866756e6374696f6e5f6578697374732827657865632729297b406578656328246366652c24726573293b247265733d6a6f696e28225c6e222c24726573293b7d656c736569662866756e6374696f6e5f65786973747328227368656c6c5f657865632229297b247265733d407368656c6c5f657865632824636665293b7d656c736569662866756e6374696f6e5f657869737473282273797374656d2229297b406f625f737461727428293b407379737465 }

condition:
	$a0
}
rule Win_Trojan_Shell_50
{
strings:
	$a0 = { 6966202866756e6374696f6e5f657869737473282765786563272929207b20406578656328246366652c24726573293b2024726573203d206a6f696e28225c6e222c24726573293b207d20656c73656966202866756e6374696f6e5f65786973747328277368656c6c5f65786563272929207b2024726573203d20407368656c6c5f657865632824636665293b207d20656c73656966202866756e6374696f6e5f657869737473282773797374656d272929207b20406f625f737461727428293b204073797374656d2824636665293b2024726573203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c73656966202866756e6374696f6e5f65786973747328277061737374687275272929207b20406f625f737461727428293b204070617373746872752824636665293b }

condition:
	$a0
}
rule Win_Trojan_Shell_53
{
strings:
	$a0 = { 69662866756e6374696f6e5f657869737473282765786563272929207b2040657865632824696e2c246f7574293b20246f75743d406a6f696e28225c6e222c246f7574293b207d656c736569662866756e6374696f6e5f65786973747328277061737374687275272929207b206f625f737461727428293b204070617373746872752824696e293b20246f75743d6f625f6765745f636c65616e28293b207d656c736569662866756e6374696f6e5f657869737473282773797374656d272929207b206f625f737461727428293b204073797374656d2824696e293b20246f75743d6f625f6765745f636c65616e28293b207d656c736569662866756e6374696f6e5f65786973747328277368656c6c5f65786563272929 }

condition:
	$a0
}
rule Win_Trojan_Shell_52
{
strings:
	$a0 = { 696620282066756e6374696f6e5f657869737473282027657865632720292029207b2040657865632820246366652c202472657320293b2024726573203d206a6f696e2820225c6e222c202472657320293b207d20656c7365696620282066756e6374696f6e5f6578697374732820277368656c6c5f657865632720292029207b2024726573203d20407368656c6c5f6578656328202463666520293b207d20656c7365696620282066756e6374696f6e5f65786973747328202773797374656d2720292029 }

condition:
	$a0
}
rule Win_Trojan_Shell_55
{
strings:
	$a0 = { 736d616c6c2070687020776562207368656c6c206279207a61636f }

condition:
	$a0
}
rule Win_Trojan_Shell_54
{
strings:
	$a0 = { 69662866756e6374696f6e5f657869737473282765786563272929207b2040657865632824636d642c24726573756c74293b2024726573756c74203d20696d706c6f646528225c6e222c24726573756c74293b207d20656c736569662866756e6374696f6e5f65786973747328277368656c6c5f657865632729292024726573756c74203d20407368656c6c5f657865632824636d64293b20656c736569662866756e6374696f6e5f657869737473282773797374656d272929 }

condition:
	$a0
}
rule Win_Trojan_Shell_57
{
strings:
	$a0 = { 6563686f28227075747261222e225f222e226172656d61222e2240796d61696c222e22636f6d22293b6563686f2822636b72696422293b }

condition:
	$a0
}
rule Win_Trojan_Shell_56
{
strings:
	$a0 = { 6563686f2822786f646f78222e225f222e226e676f72656b222e22407961686f6f222e22636f6d22293b6563686f2822636b72696422293b }

condition:
	$a0
}
rule Win_Trojan_Shell_59
{
strings:
	$a0 = { 2f2f7261772069726320636f6d6d616e6420666978656420627920746f777a616f }

condition:
	$a0
}
rule Win_Trojan_Shell_58
{
strings:
	$a0 = { 6a66397970776a68633275326e66396b7a776e767a67756f6a6639796b74736b78316739633372796468696f6a6639796c6363786d6a6d306e747a68623376707a7363736a32667664776c6c6d74697a6e6475326a796b376a663973707776797a776466636d76776267666a7a73676e78313967737578667831386e6c63696e6969346b78307975696963696c63726677636b377a787a686263676b783169706f797266756a30776f797266776430776f773d3d }

condition:
	$a0
}
rule Win_Trojan_Shell_45
{
strings:
	$a0 = { 6966202821656d7074792824636d642929207b206966202869735f63616c6c61626c65282265786563222920616e642021696e5f6172726179282265786563222c2464697361626c6566756e632929207b20657865632824636d642c24726573756c74293b2024726573756c74203d206a6f696e28225c6e222c24726573756c74293b207d20656c73656966202869735f63616c6c61626c65282273797374656d222920616e642021696e5f6172726179282273797374656d222c2464697361626c6566756e632929207b202476203d20406f625f6765745f636f6e74656e747328293b20406f625f636c65616e28293b2073797374656d2824636d64293b20 }

condition:
	$a0
}
rule Win_Trojan_Shell_48
{
strings:
	$a0 = { 3c3f706870206563686f5c2268696d6173746572215c223b696e695f736574285c226d61785f657865637574696f6e5f74696d655c222c30293b73797374656d285c2473756e747a75293b3f3e }

condition:
	$a0
}
rule Win_Trojan_Shell_49
{
strings:
	$a0 = { 6966202866756e6374696f6e5f657869737473282765786563272929207b2040657865632824696e2c246f7574293b20246f7574203d20406a6f696e28225c6e222c246f7574293b207d20656c73656966202866756e6374696f6e5f65786973747328277061737374687275272929207b206f625f737461727428293b204070617373746872752824696e293b20246f7574203d206f625f6765745f636c65616e28293b207d20656c73656966202866756e6374696f6e5f657869737473282773797374656d272929207b206f625f737461727428293b204073797374656d2824696e293b20246f7574203d206f625f6765745f636c65616e28293b207d20656c73656966202866756e6374696f6e5f65786973747328277368656c6c5f65786563272929207b20246f7574203d207368656c6c5f657865632824696e293b }

condition:
	$a0
}
rule Win_Trojan_Shell_44
{
strings:
	$a0 = { 696628245f706f73745b27[0-20]275d29207b20696e695f726573746f72652822736166655f6d6f646522293b20696e695f726573746f726528226f70656e5f6261736564697222293b2024736166656d6f646765633d7368656c6c5f65786563282465 }

condition:
	$a0
}
rule Win_Trojan_Shell_15
{
strings:
	$a0 = { 7368656c6c5f6578656329297b2473636d643d7368656c6c5f657865632824636d6e64293b20246e73636d643d68746d6c7370656369616c6368617273282473636d64293b7072696e7420246e73636d643b7d20656c73656966282166756e6374696f6e5f657869737473287368656c6c5f6578656329297b657865632824636d6e642c2465636d64293b202465636d64203d206a6f696e28225c6e222c2465636d64293b246e65636d643d68746d6c7370656369616c6368617273282465636d64293b7072696e7420246e65636d643b7d20656c73656966282166756e6374696f6e5f657869737473286578656329297b2470636d64203d20706f70656e2824636d6e642c22 }

condition:
	$a0
}
rule Win_Trojan_Shell_14
{
strings:
	$a0 = { 69662866652822657865632229297b657865632824732c2472293b24723d6a6f696e28225c6e222c2472293b7d20656c7365696628666528227368656c6c5f6578656322292924723d7368656c6c5f65786563282473293b20656c73656966286665282273797374656d2229297b6f625f737461727428293b73797374656d282473293b24723d6f625f6765745f636f6e74656e747328293b6f625f656e645f636c65616e28293b7d20656c73656966286665282270617373746872752229297b6f625f737461727428293b7061737374687275282473293b24723d6f625f67 }

condition:
	$a0
}
rule Win_Trojan_Shell_17
{
strings:
	$a0 = { 65786973747328226d797368656c6c65786563222929207b2066756e6374696f6e206d797368656c6c657865632824636d6429207b20676c6f62616c202464697361626c6566756e633b2024726573756c74203d2022223b206966202821656d7074792824636d642929207b206966202869735f63616c6c61626c65282265786563222920616e642021696e5f6172726179282265786563222c2464697361626c6566756e632929207b657865632824636d642c24726573756c74293b2024726573756c74203d206a6f696e28225c6e222c24726573756c74293b7d20656c7365696620282824726573756c74203d206024636d64602920213d3d2066616c736529207b7d20656c73656966202869735f63616c6c61626c65282273797374656d222920616e642021696e5f6172726179282273797374656d222c2464697361 }

condition:
	$a0
}
rule Win_Trojan_Shell_19
{
strings:
	$a0 = { 5f706f73745b27636f6d6d616e64275d2929207b2069662028246578656366756e633d3d2273797374656d2229207b2073797374656d28245f706f73745b27636f6d6d616e64275d293b207d20656c736569662028246578656366756e633d3d2270617373746872752229207b20706173737468727528245f706f73745b27636f6d6d616e64275d293b207d20656c736569662028246578656366756e633d3d22657865632229207b2024726573756c743d6578656328245f706f73745b22636f6d6d616e64225d293b206563686f2024726573756c743b207d20656c736569662028246578656366756e633d3d227368656c6c5f657865632229207b2024726573756c743d7368656c6c5f6578656328245f706f73745b22636f6d6d616e64225d293b206563686f2024726573756c }

condition:
	$a0
}
rule Win_Trojan_Shell_18
{
strings:
	$a0 = { 756e6374696f6e5f657869737473282765786563272929207b206966202821656d7074792824636d64292920657865632824636d642c20246f75742c2024726574293b202f2a2066756c6c206172726179206f7574707574202a2f2072657475726e20617272617928747275652c747275652c2765786563272c202727293b207d20656c73656966202866756e6374696f6e5f65786973747328277368656c6c5f65786563272929207b206966202821656d7074792824636d64292920246f75745b305d3d7368656c6c5f657865632824636d64293b202f2a2066756c6c20737472696e67206f75747075742c206e6f2072657475726e202a2f2072657475726e20617272617928747275652c66616c73652c277368656c6c5f65786563272c }

condition:
	$a0
}
rule Win_Trojan_Shell_28
{
strings:
	$a0 = { 73797374656d2824636d64293b2024726573756c74203d20406f625f6765745f636f6e74656e747328293b20406f625f636c65616e28293b206563686f2024763b207d20656c73656966202869735f63616c6c61626c6528227061737374687275222920616e642021696e5f617272617928227061737374687275222c2464697361626c6566756e632929207b202476203d20406f625f6765745f636f6e74656e747328293b20406f625f636c65616e28293b2070617373746872752824636d64293b2024726573756c74203d20406f625f6765745f636f6e74656e747328293b20406f625f636c65616e28293b206563686f2024763b207d20656c73656966202869735f7265736f7572636528246670203d20706f70656e2824636d642c227222 }

condition:
	$a0
}
rule Win_Trojan_Shell_29
{
strings:
	$a0 = { 3c3f706870206966202869737365742824636864697229292040636864697228246368646972293b206f625f73746172742820293b207061737374687275282224636d6420323e263122293b20246f7574707574203d206f625f6765745f636f6e74656e747328293b206f625f656e645f636c65616e2820293b203f3e203c3f706870206966202821656d }

condition:
	$a0
}
rule Win_Trojan_ShellcodeBindTcp_1
{
strings:
	$a0 = { fce8890000006089e531d2648b52308b520c8b52148b72280fb74a2631ff31c0ac3c617c022c20c1cf0d01c7e2f052578b52108b423c01d08b407885c0744a01d0508b48188b582001d3e33c498b348b01d631ff31c0acc1cf0d01c738e075f4037df83b7d2475e2588b582401d3668b0c4b8b581c01d38b048b01d0894424245b5b61595a51ffe0585f5a8b12eb865d6833320000687773325f54684c772607ffd5b89001000029c454506829806b00ffd5505050504050405068ea0fdfe0ffd589c731db53680200[2]89e66a10565768c2db3767ffd5535768b7e938ffffd55353576874ec3be1ffd55789c768756e4d61ffd568636d640089e357575731f66a125956e2fd66c744243c01018d442410c60044545056565646564e565653566879cc3f86ffd589e04e5646ff306808871d60ffd5bb[4]68a695bd9dffd53c067c0a80fbe07505bb4713726f6a0053ffd5 }

condition:
	$a0
}
rule Win_Trojan_ShellcodeBindTcp_2
{
strings:
	$a0 = { e856000000535556578b6c24188b453c8b54057801ea8b4a188b5a2001ebe332498b348b01ee31fffc31c0ac38e07407c1cf0d01c7ebf23b7c241475e18b5a2401eb668b0c4b8b5a1c01eb8b048b01e8eb0231c05f5e5d5bc208005e6a3059648b198b5b0c8b5b1c8b1b8b5b0853688e4e0eecffd689c781ec0001000057565389e5e82700000090010000b61918e7a41970e9e5498649a41a70c7a4ad2ee9d909f5adcbedfc3b5753325f3332005b8d4b2051ffd789df89c38d75146a07595153ff348fff55045989048ee2f22b2754ff37ff553031c05050505040504050ff552c89c7897d0ce8060000004f4c45333200ff550889c656681b06c80dff55046a026a00ffd0566880c8266eff550489c7e820000000f58a89f7c4ca3246a2ecda06e5111af242e94c30396ed840943ab913c40c9cd458508d75ec56506a016a0083c01050ffd78d4de0518b55ec8b028b4dec518b501cffd28d45f8508b4de08b118b45e0508b4a1cffd131c0508b55f88b028b4df8518b5024ffd231db5353680200[2]89e06a10508b7d0c57ff55245357ff5528535457ff552089c768434d440089e387fa31c08d7c24ac6a1559f3ab87fa83ec54c64424104466c744243c0101897c2448897c244c897c24508d442410545051515141514951515351ff75006872feb316ff5504ffd089e6ff750068add905ceff550489c36affff36ffd3ff750068[4]ff550431db53ffd0 }

condition:
	$a0
}
rule Win_Trojan_ShellHook_6
{
strings:
	$a0 = { bcbb0a0054e805160000b19bf644242c0174050fb75c24308bc35eb42ed8445bc3a8f9f9b17ca4a09cf9f9f9f99894908c014016d85356bed065833e00753a684406207682396a00f78bc8e002390185c9750533c05ea1cc0040c7828901890d33d28bc203c08d44c1048b1ee2ba0000891889064283fa6475ec8b068b10891690895aaf0de9400426a84ce0 }

condition:
	$a0
}
rule Win_Trojan_Shell_33
{
strings:
	$a0 = { 28656e61626c6564282265786563222929207b20657865632824636d642c246f293b202472657a203d206a6f696e28225c725c6e222c246f293b207d20656c736569662028656e61626c656428227368656c6c5f65786563222929207b202472657a203d207368656c6c5f657865632824636d64293b207d20656c736569662028656e61626c6564282273797374656d222929207b20406f625f737461727428293b204073797374656d2824636d64293b202472657a203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d }

condition:
	$a0
}
rule Win_Trojan_Shell_32
{
strings:
	$a0 = { 696620282821245f706f73745b27636d64275d29207c7c2028245f706f73745b27636d64275d3d3d22222929207b20245f706f73745b27636d64275d3d2269643b7077643b756e616d65202d613b6c73202d6c6164223b207d206966202828245f706f73745b27616c696173275d2920616e642028245f706f73745b27616c696173275d213d3d22222929207b20666f7265616368202824616c69617365732061732024616c6961735f6e616d653d3e24616c6961735f636d6429207b2069662028245f706f73745b27616c696173275d203d3d2024616c6961735f6e616d6529207b245f706f73745b27636d64275d3d24616c6961735f636d643b7d }

condition:
	$a0
}
rule Win_Trojan_Shell_37
{
strings:
	$a0 = { 3c746578746172656120726561646f6e6c7920726f77733d5c2231355c2220636f6c733d5c223135305c223e222e4068746d6c7370656369616c6368617273287368656c6c28245f706f73745b27636f6d6d616e64275d29292e223c2f74657874617265613e3c62723e3c696e70757420747970653d5c227375626d69745c222076616c75653d5c22657865637574655c223e }

condition:
	$a0
}
rule Win_Trojan_Shell_39
{
strings:
	$a0 = { 2f623e3c666f726d20616374696f6e3d2473656c66206d6574686f643d706f73743e3c696e70757420747970653d68696464656e206e616d653d632076616c75653d743e3c7465787461726561206e616d653d7368656c6c20726f77733d222e282169737365742824736b69707368656c6c293f31303a34292e2220636f6c733d3630207374796c653d2277696474683a313030253b223e247368656c6c3c2f74657874617265613e3c62723e3c696e70757420747970653d7375626d69743e3c2f666f726d3e3c703e223b20696620282169737365742824736b69707368656c6c2929207b206563686f20223c68722073697a653d31206e6f73686164653e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e5c6e3c786d703e223b20696620282473797374656d5f616363657373292073797374656d28247368656c6c293b20656c73652064696528 }

condition:
	$a0
}
rule Win_Trojan_Shell_38
{
strings:
	$a0 = { 5c273b206966202821656d70747928246366652929207b2069662866756e6374696f6e5f657869737473285c27657865635c272929207b20406578656328246366652c24726573293b2024726573203d206a6f696e285c225c5c6e5c222c24726573293b207d20656c736569662866756e6374696f6e5f657869737473285c277368656c6c5f657865635c272929207b2024726573203d20407368656c6c5f657865632824636665293b207d20656c736569662866756e6374696f6e5f657869737473285c2773797374656d5c272929207b20406f625f737461727428293b204073797374656d2824636665293b2024726573203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c736569662866756e6374696f6e5f657869737473285c2770617373746872755c272929207b20406f625f737461727428293b204070617373746872752824636665293b2024726573203d20406f625f6765 }

condition:
	$a0
}
rule Win_Trojan_Shell_64
{
strings:
	$a0 = { 3c3f706870202f2a207072697661746520212121207072697661746520212121207072697661746520212121 }
	$a1 = { 2d2d20646f206e6f74206469737469627574652074686973207368656c6c202d2d20646f206e6f742073656c6c2074686973207368656c6c202d2d20646f206e6f742067697665206974206576656e20746f20796f7572206d6f74686572202d2d }

condition:
	$a0 and $a1
}
rule Win_Trojan_Shell_65
{
strings:
	$a0 = { 6a0089e583e4f083ec108b5d04895c24008d4d08894c240483c301c1e30201cb895c24088b0383c30485c075f7895c240ce82c00000089442400e845300000f4e80000000058ffb04f0000008b805b220000ffe0e800000000588b804b220000ffe05589e55383ec04e8000000005b8d832a000000ffd0b80000000083c4045bc9c3 }

condition:
	$a0
}
rule Win_Trojan_Shell_66
{
strings:
	$a0 = { 7072697661746520212121[0-200]6576616c28223f3e222e677a756e636f6d7072657373286261736536345f6465636f64652822 }

condition:
	$a0
}
rule Win_Trojan_Shell_67
{
strings:
	$a0 = { 24617574685f70617373203d20223633613966306561376262393830353037393662363439653835343831383435223b0d0a24636f6c6f72203d202223646635223b0d0a2464656661756c745f616374696f6e203d202746696c65734d616e273b0d0a2464656661756c745f7573655f616a6178203d2074727565 }

condition:
	$a0
}
rule Win_Trojan_Shell_62
{
strings:
	$a0 = { 66756e6374696f6e20642824732c20246b3d2727297b696628246b3d3d2727297b666f722824693d303b24693c7374726c656e282473293b2469297b24642e3d63687228686578646563287375627374722824732c2024692c20322929293b24693d28666c6f617429282469292b323b7d72657475726e2024643b7d656c73657b24723d27273b24663d642827363236313733363533363334356636343635363336663634363527293b24753d246628275a337070626d5a735958526c27293b24733d247528246628247329293b666f722824693d303b24693c7374726c656e282473293b24692b2b297b24633d7375627374722824732c2024692c2031293b246b633d73756273747228246b2c20282469257374726c656e28246b29292d312c2031293b24633d636872286f7264282463292d6f726428246b6329293b24722e3d24633b7d72657475726e }

condition:
	$a0
}
rule Win_Trojan_Shell_20
{
strings:
	$a0 = { 206966202821656d7074792824636f6d2929207b2069662866756e6374696f6e5f657869737473282765786563272929207b20657865632824636f6d2c24617272293b206563686f20696d706c6f6465282720272c24617272293b207d20656c736569662866756e6374696f6e5f65786973747328277368656c6c5f65786563272929207b206563686f207368656c6c5f657865632824636f6d293b207d20656c736569662866756e6374696f6e5f657869737473282773797374656d272929207b206563686f2073797374656d2824636f6d293b207d20656c736569662866756e6374696f6e5f65786973747328277061737374687275272929207b206563686f2070617373746872752824636f6d }

condition:
	$a0
}
rule Win_Trojan_Shell_21
{
strings:
	$a0 = { 66756e6374696f6e5f657869737473282765786563272929207b20406578656328246366652c24726573293b2024726573203d206a6f696e28225c6e222c24726573293b207d20656c73656966284066756e6374696f6e5f65786973747328277368656c6c5f65786563272929207b2024726573203d20407368656c6c5f657865632824636665293b207d20656c73656966284066756e6374696f6e5f657869737473282773797374656d272929207b20406f625f737461727428293b204073797374656d28272463666527293b2024726573203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c73656966284066756e6374696f6e5f657869737473282770617373746872752729 }

condition:
	$a0
}
rule Win_Trojan_ShellHook_4
{
strings:
	$a0 = { 5c496e50726f6353657276657233320041706172746d656e74000000546872656164696e674d6f64656c00007b????????????????2d????????2d????????2d????????2d????????????????????????7d0000534f4654574152455c4d6963726f736f66745c57696e646f77735c43757272656e7456657273696f6e5c4578706c6f7265725c5368656c6c45786563757465486f6f6b73 }

condition:
	$a0
}
rule Win_Trojan_ShellHook_5
{
strings:
	$a0 = { 434c5349445c0000484f4f4b0000000000000000ffffffff0f0000005c496e50726f6353657276657233320041706172746d656e74000000546872656164696e674d6f64656c0000534f4654574152455c4d6963726f736f66745c57696e646f77735c43757272656e7456657273696f6e5c4578706c6f7265725c5368656c6c45786563757465486f6f6b73 }

condition:
	$a0
}
rule Win_Trojan_ShellHook_1
{
strings:
	$a0 = { 5c496e70726f6353657276657233320000000000ffffffff0900000041706172746d656e74000000546872656164696e674d6f64656c0000536f6674776172655c4d6963726f736f66745c57696e646f77735c43757272656e7456657273696f6e5c6578706c6f7265725c5368656c6c45786563757465486f6f6b73 }

condition:
	$a0
}
rule Win_Trojan_ShellHook_2
{
strings:
	$a0 = { 484f4f4b0aa3de014d5f544c421654ee9a22a40f0c420125777a449a950a0b5a3a1304bd13614604446d5b28530f6717b75dff9fb2015669727475616c51756530015318657020885772069a3bb5db93cd100f41 }

condition:
	$a0
}
rule Win_Trojan_ShellHook_3
{
strings:
	$a0 = { 484f4f4b0000882ccfff0f5c496e50726f635365725b0040587633320041706172746d656e7479160070546872656164696e674d6f64656c4f92ba7600db04754d6963736f66745c576e02a098646f77735c437572721600d6495673696f6e5c4578706c6f59801380725c53686cdabc01a06563757465486f6f6b73 }

condition:
	$a0
}
rule Win_Trojan_Shell_31
{
strings:
	$a0 = { 3c3f2073797374656d28245f6765745b27636d64275d293b20646965202822 }

condition:
	$a0
}
rule Win_Trojan_Shell_36
{
strings:
	$a0 = { 69662866756e6374696f6e5f6578697374732827657865632729297b20406578656328246366652c24726573293b2024726573203d206a6f696e28225c6e222c24726573293b207d20656c736569662866756e6374696f6e5f65786973747328277368656c6c5f657865632729297b2024726573203d20407368656c6c5f657865632824636665293b207d20656c736569662866756e6374696f6e5f657869737473282773797374656d2729297b20406f625f737461727428293b204073797374656d2824636665293b2024726573203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c73656966202866756e6374696f6e5f657869737473282770617373746872752729297b20406f625f737461727428293b204070617373746872752824636665293b }

condition:
	$a0
}
rule Win_Trojan_Shell_35
{
strings:
	$a0 = { 40696e695f726573746f72652822736166655f6d6f646522293b[0-4]40696e695f726573746f726528226f70656e5f6261736564697222293b[0-4]40696e695f726573746f72652822736166655f6d6f64655f696e636c7564655f64697222293b[0-4]40696e695f726573746f72652822736166655f6d6f64655f657865635f64697222293b[0-4]40696e695f726573746f7265282264697361626c655f66756e6374696f6e7322293b[0-4]40696e695f726573746f72652822616c6c6f775f75726c }

condition:
	$a0
}
rule Win_Trojan_Shell_34
{
strings:
	$a0 = { 69662866756e6374696f6e5f6578697374732827657865632729297b20406578656328246366652c24726573293b20247265733d6a6f696e28225c6e222c24726573293b207d20656c736569662866756e6374696f6e5f65786973747328277368656c6c5f657865632729297b20247265733d407368656c6c5f657865632824636665293b207d20656c736569662866756e6374696f6e5f657869737473282773797374656d2729297b20406f625f737461727428293b204073797374656d2824636665293b }

condition:
	$a0
}
rule Win_Trojan_ShellExec_2
{
strings:
	$a0 = { 24616374696f6e20213d20227370616d3122 }
	$a1 = { 213d22627275745f66747022 }
	$a2 = { 213d2022646f776e6c6f61645f6d61696c22 }

condition:
	$a0 and $a1 and $a2
}
rule Win_Trojan_ShellExec_3
{
strings:
	$a0 = { 24706f72747363616e2c24706f72745f61646472657332 }
	$a1 = { 246174746163683d246669 }
	$a2 = { 6861636b7275 }

condition:
	$a0 and $a1 and $a2
}
rule Win_Trojan_ShellExec_1
{
strings:
	$a0 = { 69662866756e6374696f6e5f657869737473282765786563272929[0-30]406578656328[0-50]69662866756e6374696f6e5f65786973747328277368656c6c5f65786563272929[0-30]407368656c6c5f6578656328[0-50]69662866756e6374696f6e5f657869737473282773797374656d272929[0-30]4073797374656d28[0-80]69662866756e6374696f6e5f65786973747328277061737374687275272929[0-30]40706173737468727528 }

condition:
	$a0
}
rule Win_Trojan_ShellExec_4
{
strings:
	$a0 = { 662028656e61626c6564282273797374656d222929207b20406f625f737461727428293b2073797374656d2824636d64293b202472657a203d20406f625f6765745f636f6e74656e747328293b20406f625f656e645f636c65616e28293b207d20656c736569662028656e61626c6564282265786563222929207b20657865632824636d642c246f293b202472657a203d206a6f696e28225c725c6e222c246f293b207d20656c736569662028656e61626c656428227368656c6c5f65786563 }

condition:
	$a0
}
rule Win_Trojan_ShellcodeFindKernel32_1
{
strings:
	$a0 = { 31d2b27731c9648b71308b760c8b761c8b46088b7e208b36384f1875f35901d1ffe1608b6c24248b453c8b54287801ea8b4a188b5a2001ebe334498b348b01ee31ff31c0fcac84c07407c1cf0d01c7ebf43b7c242875e18b5a2401eb668b0c4b8b5a1c01eb8b048b01e88944241c61c3 }

condition:
	$a0
}
rule Win_Trojan_Shell_1
{
strings:
	$a0 = { 0f823e01b440b96429ba00001e0e1fcd21 }

condition:
	$a0
}
rule Win_Trojan_Shell_47
{
strings:
	$a0 = { 3c3f706870206f625f636c65616e28293b6563686f5c226869206d6173746572215c223b696e695f736574285c226d61785f657865637574696f6e5f74696d655c222c30293b7061737374687275285c245f6765745b636d645d293b6469653b }

condition:
	$a0
}
rule Win_Trojan_Shell_40
{
strings:
	$a0 = { 2463757272656e74636d64203d2022636420222e2463757272656e7477642e223b222e2463757272656e74636d643b2073797374656d28222463757272656e74636d6420313e202f746d702f73656d626f6e7368656c6c20323e26313b20636174202f746d702f73656d626f6e7368656c6c3b20726d202d7266202f746d702f73656d626f6e7368656c6c22293b }

condition:
	$a0
}
rule Win_Trojan_ShellcodeReverseTcp_1
{
strings:
	$a0 = { fce8890000006089e531d2648b52308b520c8b52148b72280fb74a2631ff31c0ac3c617c022c20c1cf0d01c7e2f052578b52108b423c01d08b407885c0744a01d0508b48188b582001d3e33c498b348b01d631ff31c0acc1cf0d01c738e075f4037df83b7d2475e2588b582401d3668b0c4b8b581c01d38b048b01d0894424245b5b61595a51ffe0585f5a8b12eb865d6833320000687773325f54684c772607ffd5b89001000029c454506829806b00ffd5505050504050405068ea0fdfe0ffd589c768[4]680200[2]89e66a1056576899a57461ffd568636d640089e357575731f66a125956e2fd66c744243c01018d442410c60044545056565646564e565653566879cc3f86ffd589e04e5646ff306808871d60ffd5bb[4]68a695bd9dffd53c067c0a80fbe07505bb4713726f6a0053ffd5 }

condition:
	$a0
}

rule Php_Trojan_StopPost1 {
    strings:
        $a = { 3D 22 73 74 6F 70 5F 22 3B 24 ?? ?? ?? 3D 73 74 72 74 6F 75 70 70 65 72 28 24 ?? ?? 5B 34 5D 2E 24 ?? ?? 5B 33 5D 2E 24 ?? ?? 5B 32 5D 2E 24 ?? ?? 5B 30 5D 2E 24 ?? ?? 5B 31 5D 29 3B }
    condition:
        $a
}

rule Php_Malware_Mailbot45 {
    strings:
        $a = "echo php_os." nocase
        $b = "'](0987654321)."
        $c = "'](2222222222)."

    condition:
        all of them
}
